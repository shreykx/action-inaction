name: Update index.html on Issue Creation

on:
  issues:
    types: [opened]

jobs:
  update-index:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Extract name from issue
        id: extract_name
        run: |
          NAME=$(echo "${{ github.event.issue.body }}" | grep -oE "\b[A-Za-z]+\b" | head -n 1)
          echo "::set-output name=name::$NAME"

      - name: Modify index.html
        run: |
          sed -i '/<div class="px-4 py-2">/a \ \ \ \ <p>Hello, ${{ steps.extract_name.outputs.name }}!</p>' index.html

      - name: Commit changes
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email 'github-actions[bot]@users.noreply.github.com'
          git add index.html
          git commit -m "Update index.html with name from issue"

      - name: Push changes
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          git push
